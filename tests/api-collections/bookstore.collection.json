{
  "v": 1,
  "name": "Readify Bookstore API Tests",
  "folders": [
    {
      "name": "Books - CRUD Flow",
      "requests": [
        {
          "name": "1. GET All Books",
          "method": "GET",
          "endpoint": "http://localhost:3000/api/v1/books",
          "headers": [
            { "key": "Accept", "value": "application/json", "active": true }
          ],
          "params": [
            { "key": "page", "value": "1", "active": true },
            { "key": "limit", "value": "10", "active": true }
          ],
          "tests": "// Test 1: Status 200\npw.test('Status is 200', () => {\n  pw.expect(pw.response.status).toBe(200);\n});\n\n// Test 2: Response structure\npw.test('Response has success field', () => {\n  const json = pw.response.body;\n  pw.expect(json.success).toBe(true);\n  pw.expect(json.data).toBeType('array');\n  pw.expect(json.pagination).toBeType('object');\n});"
        },
        {
          "name": "2. POST Create Book (Valid)",
          "method": "POST",
          "endpoint": "http://localhost:3000/api/v1/books",
          "headers": [
            {
              "key": "Content-Type",
              "value": "application/json",
              "active": true
            }
          ],
          "body": {
            "contentType": "application/json",
            "body": "{\n  \"title\": \"Test Book by Hoppscotch\",\n  \"authorId\": \"1\",\n  \"isbn\": \"9781234567890\",\n  \"genre\": \"Technology\",\n  \"publishedYear\": 2024,\n  \"price\": 29.99,\n  \"stock\": 100\n}"
          },
          "tests": "// Test: 201 Created\npw.test('Status is 201', () => {\n  pw.expect(pw.response.status).toBe(201);\n});\n\n// Test: Save created ID for next requests\npw.test('Book ID saved', () => {\n  const json = pw.response.body;\n  pw.expect(json.data.id).toBeDefined();\n  // Environment variable တွင် သိမ်းခြင်း\n  pw.env.set('createdBookId', json.data.id);\n});\n\n// Test: Response data correct\npw.test('Book data is correct', () => {\n  const book = pw.response.body.data;\n  pw.expect(book.title).toBe('Test Book by Hoppscotch');\n  pw.expect(book.price).toBe(29.99);\n});"
        },
        {
          "name": "3. GET Book by ID (Retrieve Created)",
          "method": "GET",
          "endpoint": "http://localhost:3000/api/v1/books/{{createdBookId}}",
          "headers": [
            { "key": "Accept", "value": "application/json", "active": true }
          ],
          "tests": "pw.test('Status is 200', () => {\n  pw.expect(pw.response.status).toBe(200);\n});\n\npw.test('Correct book returned', () => {\n  const json = pw.response.body;\n  pw.expect(json.data.id).toBe(pw.env.get('createdBookId'));\n  pw.expect(json.data.author).toBeDefined();\n});"
        },
        {
          "name": "4. PUT Update Book (Full Update)",
          "method": "PUT",
          "endpoint": "http://localhost:3000/api/v1/books/{{createdBookId}}",
          "headers": [
            {
              "key": "Content-Type",
              "value": "application/json",
              "active": true
            }
          ],
          "body": {
            "contentType": "application/json",
            "body": "{\n  \"title\": \"Updated Test Book\",\n  \"authorId\": \"1\",\n  \"isbn\": \"9781234567890\",\n  \"genre\": \"Fiction\",\n  \"publishedYear\": 2024,\n  \"price\": 39.99,\n  \"stock\": 50\n}"
          },
          "tests": "pw.test('Status is 200', () => {\n  pw.expect(pw.response.status).toBe(200);\n});\n\npw.test('Title updated', () => {\n  pw.expect(pw.response.body.data.title).toBe('Updated Test Book');\n});\n\npw.test('Price updated', () => {\n  pw.expect(pw.response.body.data.price).toBe(39.99);\n});"
        },
        {
          "name": "5. PATCH Book Price Only",
          "method": "PATCH",
          "endpoint": "http://localhost:3000/api/v1/books/{{createdBookId}}",
          "headers": [
            {
              "key": "Content-Type",
              "value": "application/json",
              "active": true
            }
          ],
          "body": {
            "contentType": "application/json",
            "body": "{\n  \"price\": 19.99\n}"
          },
          "tests": "pw.test('Status is 200', () => {\n  pw.expect(pw.response.status).toBe(200);\n});\n\npw.test('Only price changed', () => {\n  const book = pw.response.body.data;\n  pw.expect(book.price).toBe(19.99);\n  // Title မပြောင်းရ\n  pw.expect(book.title).toBe('Updated Test Book');\n});"
        },
        {
          "name": "6. DELETE Book",
          "method": "DELETE",
          "endpoint": "http://localhost:3000/api/v1/books/{{createdBookId}}",
          "tests": "pw.test('Status is 204', () => {\n  pw.expect(pw.response.status).toBe(204);\n});\n\npw.test('No response body', () => {\n  pw.expect(pw.response.body).toBeFalsy();\n});"
        },
        {
          "name": "7. GET Deleted Book (Should 404)",
          "method": "GET",
          "endpoint": "http://localhost:3000/api/v1/books/{{createdBookId}}",
          "tests": "pw.test('Status is 404 after delete', () => {\n  pw.expect(pw.response.status).toBe(404);\n});\n\npw.test('Error response format correct', () => {\n  const json = pw.response.body;\n  pw.expect(json.success).toBe(false);\n  pw.expect(json.error.code).toBe('NOT_FOUND');\n});"
        }
      ]
    },
    {
      "name": "Validation Error Tests",
      "requests": [
        {
          "name": "POST - Missing Required Fields",
          "method": "POST",
          "endpoint": "http://localhost:3000/api/v1/books",
          "headers": [
            {
              "key": "Content-Type",
              "value": "application/json",
              "active": true
            }
          ],
          "body": {
            "contentType": "application/json",
            "body": "{\n  \"genre\": \"Fiction\"\n}"
          },
          "tests": "pw.test('Status is 400 for missing fields', () => {\n  pw.expect(pw.response.status).toBe(400);\n});\n\npw.test('Validation error code', () => {\n  pw.expect(pw.response.body.error.code).toBe('VALIDATION_ERROR');\n});\n\npw.test('Error message mentions title', () => {\n  pw.expect(pw.response.body.error.message).toContain('title');\n});"
        },
        {
          "name": "POST - Invalid ISBN Format",
          "method": "POST",
          "endpoint": "http://localhost:3000/api/v1/books",
          "body": {
            "contentType": "application/json",
            "body": "{\n  \"title\": \"Test\",\n  \"authorId\": \"1\",\n  \"isbn\": \"invalid-isbn\",\n  \"price\": 10.00\n}"
          },
          "tests": "pw.test('Status 400 for invalid ISBN', () => {\n  pw.expect(pw.response.status).toBe(400);\n});"
        },
        {
          "name": "POST - Negative Price",
          "method": "POST",
          "endpoint": "http://localhost:3000/api/v1/books",
          "body": {
            "contentType": "application/json",
            "body": "{\n  \"title\": \"Test Book\",\n  \"authorId\": \"1\",\n  \"isbn\": \"9781234567891\",\n  \"price\": -5\n}"
          },
          "tests": "pw.test('Status 400 for negative price', () => {\n  pw.expect(pw.response.status).toBe(400);\n});"
        }
      ]
    },
    {
      "name": "Authors Endpoints",
      "requests": [
        {
          "name": "GET All Authors",
          "method": "GET",
          "endpoint": "http://localhost:3000/api/v1/authors",
          "tests": "pw.test('Status 200', () => pw.expect(pw.response.status).toBe(200));\npw.test('Array returned', () => pw.expect(pw.response.body.data).toBeType('array'));"
        },
        {
          "name": "GET Author with Books",
          "method": "GET",
          "endpoint": "http://localhost:3000/api/v1/authors/1",
          "tests": "pw.test('Status 200', () => pw.expect(pw.response.status).toBe(200));\npw.test('Books included', () => pw.expect(pw.response.body.data.books).toBeType('array'));"
        }
      ]
    },
    {
      "name": "Health Check",
      "requests": [
        {
          "name": "GET /health",
          "method": "GET",
          "endpoint": "http://localhost:3000/health",
          "tests": "pw.test('API is healthy', () => {\n  pw.expect(pw.response.status).toBe(200);\n  pw.expect(pw.response.body.status).toBe('healthy');\n  pw.expect(pw.response.body.uptime).toBeDefined();\n});"
        }
      ]
    }
  ]
}
